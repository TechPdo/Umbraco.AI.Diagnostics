name: Manual Build â€“ Umbraco.AI.Diagnostics

on:
  workflow_dispatch:   # ðŸ”¹ Only manual runs, no automatic triggers

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # ---------------------------
    # Checkout the code
    # ---------------------------
    - name: Checkout
      uses: actions/checkout@v4

    # ---------------------------
    # Setup .NET 10 (Umbraco 17)
    # ---------------------------
    - name: Setup .NET 10
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '10.0.x'
        include-prerelease: true

    # ---------------------------
    # Setup Node / TypeScript
    # ---------------------------
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'

    - name: Build TypeScript Client
      working-directory: src/Umbraco.AI.Diagnostics/Client
      run: |
        npm ci
        npm run build

    # ---------------------------
    # Restore & Build .NET Project
    # ---------------------------
    - name: Restore .NET Dependencies
      run: dotnet restore src/Umbraco.AI.Diagnostics/Umbraco.AI.Diagnostics.csproj

    - name: Build .NET Project
      run: dotnet build src/Umbraco.AI.Diagnostics/Umbraco.AI.Diagnostics.csproj -c Release
