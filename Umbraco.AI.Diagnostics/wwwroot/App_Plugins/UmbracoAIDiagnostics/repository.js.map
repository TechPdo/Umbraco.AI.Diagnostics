{"version":3,"file":"repository.js","sources":["../../../Client/src/repository.ts"],"sourcesContent":["import { UmbControllerBase } from '@umbraco-cms/backoffice/class-api';\r\nimport { UmbContextToken } from '@umbraco-cms/backoffice/context-api';\r\n\r\nexport const UMBRACO_AI_DIAGNOSTICS_REPOSITORY_ALIAS = 'UmbracoAIDiagnostics.Repository';\r\n\r\nexport interface AnalysisRequest {\r\n    logLevels: string[];\r\n    timeRange: string;\r\n}\r\n\r\nexport class UmbracoAIDiagnosticsRepository extends UmbControllerBase {\r\n\r\n    async analyzeWithFilters(logLevels: string[], timeRange: string): Promise<{ data: any } | undefined> {\r\n        try {\r\n            // POST endpoint with filters\r\n            const response = await fetch('/umbraco/backoffice/umbracoaidiagnostics/api/aidiagnostics/analyze', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    logLevels: logLevels,\r\n                    timeRange: timeRange\r\n                })\r\n            });\r\n\r\n            if (!response.ok) {\r\n                console.error('Failed to analyze logs:', response.status, response.statusText);\r\n                const text = await response.text();\r\n                console.error('Response body:', text);\r\n                return undefined;\r\n            }\r\n\r\n            const json = await response.json();\r\n            return { data: json };\r\n\r\n        } catch (error) {\r\n            console.error('Error analyzing logs:', error);\r\n            return undefined;\r\n        }\r\n    }\r\n}\r\n\r\nexport const UMBRACO_AI_DIAGNOSTICS_REPOSITORY_CONTEXT = new UmbContextToken<UmbracoAIDiagnosticsRepository>(\r\n    UMBRACO_AI_DIAGNOSTICS_REPOSITORY_ALIAS\r\n);\r\n\r\nexport default UmbracoAIDiagnosticsRepository;"],"names":["UMBRACO_AI_DIAGNOSTICS_REPOSITORY_ALIAS","UmbracoAIDiagnosticsRepository","UmbControllerBase","logLevels","timeRange","response","text","error","UMBRACO_AI_DIAGNOSTICS_REPOSITORY_CONTEXT","UmbContextToken"],"mappings":";;AAGO,MAAMA,IAA0C;AAOhD,MAAMC,UAAuCC,EAAkB;AAAA,EAElE,MAAM,mBAAmBC,GAAqBC,GAAuD;AACjG,QAAI;AAEA,YAAMC,IAAW,MAAM,MAAM,sEAAsE;AAAA,QAC/F,QAAQ;AAAA,QACR,SAAS;AAAA,UACL,gBAAgB;AAAA,QAAA;AAAA,QAEpB,MAAM,KAAK,UAAU;AAAA,UACjB,WAAAF;AAAA,UACA,WAAAC;AAAA,QAAA,CACH;AAAA,MAAA,CACJ;AAED,UAAI,CAACC,EAAS,IAAI;AACd,gBAAQ,MAAM,2BAA2BA,EAAS,QAAQA,EAAS,UAAU;AAC7E,cAAMC,IAAO,MAAMD,EAAS,KAAA;AAC5B,gBAAQ,MAAM,kBAAkBC,CAAI;AACpC;AAAA,MACJ;AAGA,aAAO,EAAE,MADI,MAAMD,EAAS,KAAA,EACb;AAAA,IAEnB,SAASE,GAAO;AACZ,cAAQ,MAAM,yBAAyBA,CAAK;AAC5C;AAAA,IACJ;AAAA,EACJ;AACJ;AAEO,MAAMC,IAA4C,IAAIC;AAAA,EACzDT;AACJ;"}