{"version":3,"file":"workspace-view.js","sources":["../../../Client/src/workspace-view.ts"],"sourcesContent":["import { UmbElementMixin } from '@umbraco-cms/backoffice/element-api';\r\nimport { LitElement, html, css, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbracoAIDiagnosticsRepository } from './repository';\r\nimport { unsafeHTML } from '@umbraco-cms/backoffice/external/lit';\r\n\r\n@customElement('umbraco-ai-diagnostics-workspace-view')\r\nexport class UmbracoAIDiagnosticsWorkspaceViewElement extends UmbElementMixin(LitElement) {\r\n\r\n    @state()\r\n    private _loading: boolean = false;\r\n\r\n    @state()\r\n    private _error: string = '';\r\n\r\n    @state()\r\n    private _report: any = null;\r\n\r\n    @state()\r\n    private _criticalChecked: boolean = true;\r\n\r\n    @state()\r\n    private _errorChecked: boolean = true;\r\n\r\n    @state()\r\n    private _warningChecked: boolean = true;\r\n\r\n    @state()\r\n    private _timeRange: string = '1hour';\r\n\r\n    #repository?: UmbracoAIDiagnosticsRepository;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#repository = new UmbracoAIDiagnosticsRepository(this);\r\n    }\r\n\r\n    // Add the markdown rendering function\r\n    private renderMarkdown(text: string): string {\r\n        if (!text) return '';\r\n\r\n        let html = text;\r\n\r\n        // Code blocks (must be before inline code)\r\n        html = html.replace(/```(\\w+)?\\r?\\n([\\s\\S]*?)```/g, (_, lang, code) => {\r\n            // Escape HTML in code blocks only\r\n            const escapedCode = code\r\n                .replace(/&/g, '&amp;')\r\n                .replace(/</g, '&lt;')\r\n                .replace(/>/g, '&gt;');\r\n            return `<pre><code class=\"language-${lang || 'plaintext'}\">${escapedCode.trim()}</code></pre>`;\r\n        });\r\n\r\n        // Inline code\r\n        html = html.replace(/`([^`]+)`/g, (_, code) => {\r\n            const escapedCode = code\r\n                .replace(/&/g, '&amp;')\r\n                .replace(/</g, '&lt;')\r\n                .replace(/>/g, '&gt;');\r\n            return `<code>${escapedCode}</code>`;\r\n        });\r\n\r\n        // Bold (must be before italic) - NON-GREEDY matching\r\n        html = html.replace(/\\*\\*([^\\*]+?)\\*\\*/g, '<strong>$1</strong>');\r\n        html = html.replace(/__([^_]+?)__/g, '<strong>$1</strong>');\r\n\r\n        // Italic - NON-GREEDY matching\r\n        html = html.replace(/\\*([^\\*]+?)\\*/g, '<em>$1</em>');\r\n        html = html.replace(/_([^_]+?)_/g, '<em>$1</em>');\r\n\r\n        // Strikethrough\r\n        html = html.replace(/~~(.+?)~~/g, '<del>$1</del>');\r\n\r\n        // Headers (must be processed before paragraphs)\r\n        html = html.replace(/^######\\s+(.+)$/gm, '<h6>$1</h6>');\r\n        html = html.replace(/^#####\\s+(.+)$/gm, '<h5>$1</h5>');\r\n        html = html.replace(/^####\\s+(.+)$/gm, '<h4>$1</h4>');\r\n        html = html.replace(/^###\\s+(.+)$/gm, '<h3>$1</h3>');\r\n        html = html.replace(/^##\\s+(.+)$/gm, '<h2>$1</h2>');\r\n        html = html.replace(/^#\\s+(.+)$/gm, '<h1>$1</h1>');\r\n\r\n        // Links\r\n        html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"$2\" target=\"_blank\" rel=\"noopener noreferrer\">$1</a>');\r\n\r\n        // Images\r\n        html = html.replace(/!\\[([^\\]]*)\\]\\(([^)]+)\\)/g, '<img src=\"$2\" alt=\"$1\" />');\r\n\r\n        // Blockquotes\r\n        html = html.replace(/^>\\s+(.+)$/gm, '<blockquote>$1</blockquote>');\r\n\r\n        // Horizontal rules\r\n        html = html.replace(/^---$/gm, '<hr>');\r\n        html = html.replace(/^\\*\\*\\*$/gm, '<hr>');\r\n\r\n        // Unordered lists - improved handling\r\n        const unorderedListRegex = /(?:^\\*\\s+.+$\\n?)+/gm;\r\n        html = html.replace(unorderedListRegex, (match) => {\r\n            const items = match.split('\\n').filter(line => line.trim());\r\n            const listItems = items.map(item => {\r\n                const content = item.replace(/^\\*\\s+/, '');\r\n                return `<li>${content}</li>`;\r\n            }).join('');\r\n            return `<ul>${listItems}</ul>`;\r\n        });\r\n\r\n        // Also handle lists with dashes\r\n        const dashListRegex = /(?:^-\\s+.+$\\n?)+/gm;\r\n        html = html.replace(dashListRegex, (match) => {\r\n            const items = match.split('\\n').filter(line => line.trim());\r\n            const listItems = items.map(item => {\r\n                const content = item.replace(/^-\\s+/, '');\r\n                return `<li>${content}</li>`;\r\n            }).join('');\r\n            return `<ul>${listItems}</ul>`;\r\n        });\r\n\r\n        // Ordered lists - improved handling\r\n        const orderedListRegex = /(?:^\\d+\\.\\s+.+$\\n?)+/gm;\r\n        html = html.replace(orderedListRegex, (match) => {\r\n            const items = match.split('\\n').filter(line => line.trim());\r\n            const listItems = items.map(item => {\r\n                const content = item.replace(/^\\d+\\.\\s+/, '');\r\n                return `<li>${content}</li>`;\r\n            }).join('');\r\n            return `<ol>${listItems}</ol>`;\r\n        });\r\n\r\n        // Line breaks and paragraphs (do this last)\r\n        html = html.replace(/\\n\\n+/g, '</p><p>');\r\n        html = html.replace(/\\n/g, '<br>');\r\n\r\n        // Wrap content in paragraph if it doesn't start with a block element\r\n        if (!html.match(/^<(h[1-6]|ul|ol|pre|blockquote|hr)/)) {\r\n            html = `<p>${html}</p>`;\r\n        }\r\n\r\n        // Clean up - remove p tags around block elements\r\n        html = html.replace(/<p>(<h[1-6]>)/g, '$1');\r\n        html = html.replace(/(<\\/h[1-6]>)<\\/p>/g, '$1');\r\n        html = html.replace(/<p>(<ul>)/g, '$1');\r\n        html = html.replace(/(<\\/ul>)<\\/p>/g, '$1');\r\n        html = html.replace(/<p>(<ol>)/g, '$1');\r\n        html = html.replace(/(<\\/ol>)<\\/p>/g, '$1');\r\n        html = html.replace(/<p>(<pre>)/g, '$1');\r\n        html = html.replace(/(<\\/pre>)<\\/p>/g, '$1');\r\n        html = html.replace(/<p>(<blockquote>)/g, '$1');\r\n        html = html.replace(/(<\\/blockquote>)<\\/p>/g, '$1');\r\n        html = html.replace(/<p>(<hr>)<\\/p>/g, '$1');\r\n        html = html.replace(/<p><\\/p>/g, '');\r\n\r\n        return html;\r\n    }\r\n\r\n    async #handleAnalyze() {\r\n        this._loading = true;\r\n        this._error = '';\r\n        this._report = null;\r\n\r\n        if (!this.#repository) {\r\n            this._error = 'Repository not initialized';\r\n            this._loading = false;\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Collect selected log levels\r\n            const logLevels: string[] = [];\r\n            if (this._criticalChecked) logLevels.push('Critical');\r\n            if (this._errorChecked) logLevels.push('Error');\r\n            if (this._warningChecked) logLevels.push('Warning');\r\n\r\n            if (logLevels.length === 0) {\r\n                this._error = 'Please select at least one log level';\r\n                this._loading = false;\r\n                return;\r\n            }\r\n\r\n            // Call the repository method with filters\r\n            const result = await this.#repository.analyzeWithFilters(logLevels, this._timeRange);\r\n\r\n            if (result) {\r\n                this._report = result.data;\r\n            } else {\r\n                this._error = 'Failed to load AI diagnostics';\r\n            }\r\n        } catch (error) {\r\n            this._error = `Error: ${error}`;\r\n            console.error('Error analyzing logs:', error);\r\n        }\r\n\r\n        this._loading = false;\r\n    }\r\n\r\n    #handleCriticalChange(e: Event) {\r\n        const checkbox = e.target as HTMLInputElement;\r\n        this._criticalChecked = checkbox.checked;\r\n    }\r\n\r\n    #handleErrorChange(e: Event) {\r\n        const checkbox = e.target as HTMLInputElement;\r\n        this._errorChecked = checkbox.checked;\r\n    }\r\n\r\n    #handleWarningChange(e: Event) {\r\n        const checkbox = e.target as HTMLInputElement;\r\n        this._warningChecked = checkbox.checked;\r\n    }\r\n\r\n    #handleTimeRangeChange(e: Event) {\r\n        const select = e.target as HTMLSelectElement;\r\n        this._timeRange = select.value;\r\n        console.log('Time range changed to:', this._timeRange);\r\n    }\r\n\r\n    private renderFilters() {\r\n        return html`\r\n      <uui-box headline=\"Analysis Filters\">\r\n        <div class=\"filters-container\">\r\n          <div class=\"label-group\">\r\n            <label>Log Type:</label>\r\n          </div>\r\n          \r\n          <div class=\"checkboxes-group\">\r\n            <uui-checkbox\r\n              label=\"Critical\"\r\n              .checked=${this._criticalChecked}\r\n              @change=${this.#handleCriticalChange}\r\n            ></uui-checkbox>\r\n            \r\n            <uui-checkbox\r\n              label=\"Error\"\r\n              .checked=${this._errorChecked}\r\n              @change=${this.#handleErrorChange}\r\n            ></uui-checkbox>\r\n            \r\n            <uui-checkbox\r\n              label=\"Warning\"\r\n              .checked=${this._warningChecked}\r\n              @change=${this.#handleWarningChange}\r\n            ></uui-checkbox>\r\n          </div>\r\n\r\n          <div class=\"label-group\">\r\n            <label>Time Range:</label>\r\n          </div>\r\n\r\n          <div class=\"dropdown-group\">\r\n            <select\r\n              class=\"time-range-select\"\r\n              .value=${this._timeRange}\r\n              @change=${this.#handleTimeRangeChange}\r\n            >\r\n              <option value=\"1hour\" ?selected=${this._timeRange === '1hour'}>Last 1 hour</option>\r\n              <option value=\"2hours\" ?selected=${this._timeRange === '2hours'}>Last 2 hours</option>\r\n              <option value=\"24hours\" ?selected=${this._timeRange === '24hours'}>Last 24 hours</option>\r\n              <option value=\"7days\" ?selected=${this._timeRange === '7days'}>Last 7 days</option>\r\n              <option value=\"1month\" ?selected=${this._timeRange === '1month'}>Last month</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div class=\"button-group\">\r\n            <uui-button\r\n              look=\"primary\"\r\n              label=\"Analyze\"\r\n              @click=${this.#handleAnalyze}\r\n              ?disabled=${this._loading}\r\n            >\r\n              <uui-icon name=\"wand\"></uui-icon>\r\n              Analyze\r\n            </uui-button>\r\n          </div>\r\n        </div>\r\n      </uui-box>\r\n    `;\r\n    }\r\n\r\n    private renderResults() {\r\n        if (!this._report) return null;\r\n\r\n        return html`\r\n      <uui-box headline=\"Analysis Results\">\r\n        <div class=\"stack\">\r\n          <div class=\"inline\">\r\n            <uui-tag>Total logs: ${this._report.totalLogsAnalyzed || 0}</uui-tag>\r\n            <uui-tag>Unique issues: ${this._report.uniqueLogsCount || 0}</uui-tag>\r\n            <uui-tag>Range: ${this._report.timeRange || this._timeRange}</uui-tag>\r\n          </div>\r\n          \r\n          ${this._report.aiSummary ? html`\r\n            <uui-box headline=\"AI Summary\">\r\n              <div class=\"ai-summary markdown-content\">${unsafeHTML(this.renderMarkdown(this._report.aiSummary))}</div>\r\n            </uui-box>\r\n          ` : ''}\r\n          \r\n          ${this._report.logAnalysisItems?.length ? html`\r\n            <div class=\"logs\">\r\n              ${this._report.logAnalysisItems.map((item: any) => html`\r\n                <uui-box>\r\n                  <div class=\"inline\">\r\n                    <uui-badge color=\"danger\">${item.logEntry?.level || 'Unknown'}</uui-badge>\r\n                    <uui-tag>${item.occurrenceCount || 1} occurrences</uui-tag>\r\n                    <uui-badge color=\"danger\">${item.logEntry?.severityAssessment || 'Unknown'}</uui-badge>\r\n                  </div>\r\n                  <p>\r\n                    <strong>${item.logEntry?.timestamp ? new Date(item.logEntry.timestamp).toLocaleString() : 'No timestamp'}</strong>\r\n                  </p>\r\n                  <pre>${item.logEntry?.message || 'No message'}</pre>\r\n                  \r\n                  ${item.likelyCause ? html`\r\n                    <div class=\"markdown-content\">\r\n                      <strong>Likely cause:</strong>\r\n                      <div>${unsafeHTML(this.renderMarkdown(item.likelyCause))}</div>\r\n                    </div>\r\n                  ` : ''}\r\n                  \r\n                  ${item.suggestedFixes?.length ? html`\r\n                    <div class=\"suggested-fixes markdown-content\">\r\n                      <strong>Suggested fixes:</strong>\r\n                      <div>\r\n                        ${item.suggestedFixes.map((fix: string) => html`\r\n                          <div class=\"fix-item\">${unsafeHTML(this.renderMarkdown(fix))}</div>\r\n                        `)}\r\n                      </div>\r\n                    </div>\r\n                  ` : ''}\r\n                </uui-box>\r\n              `)}\r\n            </div>\r\n          ` : html`\r\n            <p class=\"no-logs\">No log entries found for the selected criteria.</p>\r\n          `}\r\n        </div>\r\n      </uui-box>\r\n    `;\r\n    }\r\n\r\n    render() {\r\n        return html`\r\n      <div class=\"container\">\r\n        ${this.renderFilters()}\r\n        \r\n        ${this._loading ? html`\r\n          <uui-box>\r\n            <div class=\"loading-container\">\r\n              <uui-loader></uui-loader>\r\n              <p>Analyzing logs...</p>\r\n            </div>\r\n          </uui-box>\r\n        ` : ''}\r\n        \r\n        ${this._error ? html`\r\n          <uui-box headline=\"Error\" color=\"danger\">\r\n            <p>${this._error}</p>\r\n          </uui-box>\r\n        ` : ''}\r\n        \r\n        ${this.renderResults()}\r\n      </div>\r\n    `;\r\n    }\r\n\r\n    static styles = css`\r\n    :host {\r\n      display: block;\r\n      padding: var(--uui-size-space-5);\r\n    }\r\n\r\n    .container {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: var(--uui-size-space-5);\r\n    }\r\n\r\n    .filters-container {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: flex-end;\r\n      gap: var(--uui-size-space-3);\r\n      padding: var(--uui-size-space-4);\r\n    }\r\n\r\n    .label-group {\r\n      display: flex;\r\n      align-items: center;\r\n    }\r\n\r\n    .label-group label {\r\n      font-size: 0.875rem;\r\n      font-weight: 600;\r\n      color: var(--uui-color-text);\r\n      white-space: nowrap;\r\n    }\r\n\r\n    .checkboxes-group {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n      gap: var(--uui-size-space-4);\r\n      margin-right: var(--uui-size-space-6);\r\n    }\r\n\r\n    .dropdown-group {\r\n      display: flex;\r\n      align-items: center;\r\n      width: 180px;\r\n      margin-right: var(--uui-size-space-4);\r\n    }\r\n\r\n    .dropdown-group uui-select {\r\n      width: 100%;\r\n    }\r\n\r\n    .time-range-select {\r\n      width: 100%;\r\n      height: 36px;\r\n      padding: 0 var(--uui-size-space-3);\r\n      border: 1px solid var(--uui-color-border);\r\n      border-radius: var(--uui-border-radius);\r\n      background-color: var(--uui-color-surface);\r\n      color: var(--uui-color-text);\r\n      font-family: inherit;\r\n      font-size: 0.875rem;\r\n      cursor: pointer;\r\n      outline: none;\r\n      transition: border-color 0.2s ease;\r\n    }\r\n\r\n    .time-range-select:hover {\r\n      border-color: var(--uui-color-border-emphasis);\r\n    }\r\n\r\n    .time-range-select:focus {\r\n      border-color: var(--uui-color-focus);\r\n      box-shadow: 0 0 0 2px rgba(var(--uui-color-focus-rgb), 0.2);\r\n    }\r\n\r\n    .time-range-select option {\r\n      padding: var(--uui-size-space-2);\r\n      background-color: var(--uui-color-surface);\r\n      color: var(--uui-color-text);\r\n    }\r\n\r\n    .button-group {\r\n      display: flex;\r\n      align-items: center;\r\n    }\r\n\r\n    .stack {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: var(--uui-size-space-4);\r\n    }\r\n\r\n    .inline {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: var(--uui-size-space-3);\r\n      flex-wrap: wrap;\r\n    }\r\n\r\n    .loading-container {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: var(--uui-size-space-6);\r\n      gap: var(--uui-size-space-3);\r\n    }\r\n\r\n    .ai-summary {\r\n      padding: var(--uui-size-space-3);\r\n      line-height: 1.6;\r\n      color: var(--uui-color-text);\r\n    }\r\n\r\n    .logs {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: var(--uui-size-space-4);\r\n    }\r\n\r\n    .logs uui-box {\r\n      background: var(--uui-color-surface);\r\n    }\r\n\r\n    .logs p {\r\n      margin: var(--uui-size-space-2) 0;\r\n      color: var(--uui-color-text);\r\n    }\r\n\r\n    .logs pre {\r\n      background: var(--uui-color-surface-alt);\r\n      padding: var(--uui-size-space-3);\r\n      border-radius: var(--uui-border-radius);\r\n      overflow-x: auto;\r\n      margin: var(--uui-size-space-3) 0;\r\n      font-family: 'Courier New', monospace;\r\n      font-size: 0.9em;\r\n      line-height: 1.4;\r\n      color: var(--uui-color-text);\r\n    }\r\n\r\n    .suggested-fixes {\r\n      margin-top: var(--uui-size-space-3);\r\n    }\r\n\r\n    .suggested-fixes ul {\r\n      margin: var(--uui-size-space-2) 0;\r\n      padding-left: var(--uui-size-space-5);\r\n    }\r\n\r\n    .suggested-fixes li {\r\n      margin-bottom: var(--uui-size-space-2);\r\n      line-height: 1.5;\r\n      color: var(--uui-color-text);\r\n    }\r\n\r\n    .no-logs {\r\n      text-align: center;\r\n      padding: var(--uui-size-space-6);\r\n      color: var(--uui-color-text-alt);\r\n      font-style: italic;\r\n    }\r\n\r\n    uui-loader {\r\n      font-size: 2em;\r\n    }\r\n\r\n    strong {\r\n      font-weight: 600;\r\n      color: var(--uui-color-text-alt);\r\n    }\r\n    .inline > uui-badge {\r\n        margin-right: 0px;\r\n        position: inherit;\r\n    }\r\n    uui-badge {\r\n      text-transform: uppercase;\r\n      font-weight: 600;\r\n    }\r\n\r\n    /* Markdown content styles */\r\n    .markdown-content {\r\n      line-height: 1.6;\r\n    }\r\n\r\n    .markdown-content p {\r\n      margin: var(--uui-size-space-2) 0;\r\n    }\r\n\r\n    .markdown-content strong {\r\n      font-weight: 600;\r\n    }\r\n\r\n    .markdown-content em {\r\n      font-style: italic;\r\n    }\r\n\r\n    .markdown-content code {\r\n      background: var(--uui-color-surface-alt);\r\n      padding: 2px 6px;\r\n      border-radius: 3px;\r\n      font-family: 'Courier New', monospace;\r\n      font-size: 0.9em;\r\n    }\r\n\r\n    .markdown-content pre {\r\n      background: var(--uui-color-surface-alt);\r\n      padding: var(--uui-size-space-3);\r\n      border-radius: var(--uui-border-radius);\r\n      overflow-x: auto;\r\n      margin: var(--uui-size-space-3) 0;\r\n    }\r\n\r\n    .markdown-content pre code {\r\n      background: none;\r\n      padding: 0;\r\n    }\r\n\r\n    .markdown-content ul,\r\n    .markdown-content ol {\r\n      margin: var(--uui-size-space-2) 0;\r\n      padding-left: var(--uui-size-space-5);\r\n    }\r\n\r\n    .markdown-content li {\r\n      margin-bottom: var(--uui-size-space-1);\r\n    }\r\n\r\n    .markdown-content h1,\r\n    .markdown-content h2,\r\n    .markdown-content h3,\r\n    .markdown-content h4,\r\n    .markdown-content h5,\r\n    .markdown-content h6 {\r\n      margin: var(--uui-size-space-3) 0 var(--uui-size-space-2) 0;\r\n      font-weight: 600;\r\n    }\r\n\r\n    .markdown-content h1 { font-size: 1.5em; }\r\n    .markdown-content h2 { font-size: 1.3em; }\r\n    .markdown-content h3 { font-size: 1.1em; }\r\n\r\n    .markdown-content blockquote {\r\n      border-left: 3px solid var(--uui-color-border);\r\n      padding-left: var(--uui-size-space-3);\r\n      margin: var(--uui-size-space-3) 0;\r\n      color: var(--uui-color-text-alt);\r\n    }\r\n\r\n    .markdown-content hr {\r\n      border: none;\r\n      border-top: 1px solid var(--uui-color-border);\r\n      margin: var(--uui-size-space-4) 0;\r\n    }\r\n\r\n    .markdown-content a {\r\n      color: var(--uui-color-interactive);\r\n      text-decoration: none;\r\n    }\r\n\r\n    .markdown-content a:hover {\r\n      text-decoration: underline;\r\n    }\r\n\r\n    .fix-item {\r\n      margin-bottom: var(--uui-size-space-2);\r\n    }\r\n  `;\r\n}\r\n\r\nexport default UmbracoAIDiagnosticsWorkspaceViewElement;\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        'umbraco-ai-diagnostics-workspace-view': UmbracoAIDiagnosticsWorkspaceViewElement;\r\n    }\r\n}"],"names":["_repository","_UmbracoAIDiagnosticsWorkspaceViewElement_instances","handleAnalyze_fn","handleCriticalChange_fn","handleErrorChange_fn","handleWarningChange_fn","handleTimeRangeChange_fn","UmbracoAIDiagnosticsWorkspaceViewElement","UmbElementMixin","LitElement","__privateAdd","__privateSet","UmbracoAIDiagnosticsRepository","text","html","_","lang","code","escapedCode","unorderedListRegex","match","line","item","dashListRegex","orderedListRegex","__privateMethod","unsafeHTML","fix","__privateGet","logLevels","result","error","e","checkbox","select","css","__decorateClass","state","customElement","UmbracoAIDiagnosticsWorkspaceViewElement_default"],"mappings":"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"}